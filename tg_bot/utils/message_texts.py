from datetime import date, timedelta, datetime

from database import CrudeUser, CrudeSubscriptions

# ๐ ะกัะฐััะพะฒะพะต ัะพะพะฑัะตะฝะธะต
start_text = '''
๐ ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะฒ NFT Time Bot!

๐ ะะดะตัั ัั ะผะพะถะตัั ะฟะตัะฒัะผ ัะทะฝะฐัั ะพ ะฒััะพะดะต 
ัะฝะธะบะฐะปัะฝัั NFT-ะฟะพะดะฐัะบะพะฒ ๐ผ๏ธโจ

๐ ะะผะธ ะฝะฐ ะผะตะฝั ะธ ะธ ะฑัะดั ั ะฝะฐะผะธ๐ฎ๐ฒ
'''

pay_info_text = '''
๐ฏ ะะพะทะผะพะถะฝะพััะธ:
โข ๐ ะะฒัะพะผะฐัะธัะตัะบะธะต ัะฒะตะดะพะผะปะตะฝะธั ะพ ะฝะพะฒัั ัะตะปะธะทะฐั  
โข ๐ ะะพะดะฟะธัะบะฐ โ ะฒัะตะณะพ ะทะฐ 79 ะทะฒัะทะด Telegram โญ ะฒ ะผะตััั
'''

# โน๏ธ ะะฝัะพัะผะฐัะธั ะพ ะฑะพัะต
info_bot_text = """
<b>๐ค ะญัะพั ะฑะพั ัะฒะตะดะพะผะปัะตั ะฒะฐั ะพ ะฒััะพะดะต ะฝะพะฒัั NFT-ะฟะพะดะฐัะบะพะฒ ๐ ะฒ Telegram ๐ฒ</b>

<pre>โธป</pre>

<b>๐ฏ ะะพะทะผะพะถะฝะพััะธ:</b>
โข ๐ <b>ะะฒัะพะผะฐัะธัะตัะบะธะต ัะฒะตะดะพะผะปะตะฝะธั</b> ะพ ะฝะพะฒัั ัะตะปะธะทะฐั  
โข ๐ <b>ะะพะดะฟะธัะบะฐ</b> โ ะฒัะตะณะพ ะทะฐ <u>79 ะทะฒัะทะด Telegram โญ</u> ะฒ ะผะตััั

<pre>โธป</pre>

<b>๐ ะะฐะบ ัะฐะฑะพัะฐะตั:</b>
โข ๐ฐ๏ธ ะะพั <b>ะฝะตะฟัะตััะฒะฝะพ ะพััะปะตะถะธะฒะฐะตั</b> ะฟะพัะฒะปะตะฝะธะต ะฝะพะฒัั NFT  
โข ๐ฌ ะกัะฐะทั ะฟะพัะปะต <b>ะดะพะฑะฐะฒะปะตะฝะธั ะฝะพะฒะพะณะพ ะฟะพะดะฐัะบะฐ</b> ะฒั ะฟะพะปััะฐะตัะต ัะฒะตะดะพะผะปะตะฝะธะต  
โข ๐ <b>ะัะพะฒะตัะธัั ััะฐััั ะฟะพะดะฟะธัะบะธ</b> ะผะพะถะฝะพ ะฒัััะฝัั ะฒ ะปัะฑะพะต ะฒัะตะผั ัะตัะตะท ะผะตะฝั

<pre>โธป</pre>

<b>๐ข ะัะดััะต ะฒ ะบัััะต:</b>

ะะพะดะฟะธััะฒะฐะนัะตัั ะฝะฐ ะฝะฐั ะบะฐะฝะฐะป ๐ก, ััะพะฑั ะฝะต ะฟัะพะฟัััะธัั ะฝะพะฒะธะฝะบะธ ะธ ะพะฑะฝะพะฒะปะตะฝะธั:  
๐ <a href="https://t.me/Nft_News_Crypta">@Nft_News_Crypta</a>
"""

# ๐ ะขะตะบััะธะน ััะฐััั ะฟะพะดะฟะธัะบะธ
status_txt = (
    "๐ ะกะตะนัะฐั ะฝะตั ะฝะพะฒัั ะฟะพะดะฐัะบะพะฒ.\n"
    "โ ะะฐะบ ัะพะปัะบะพ ะฟะพัะฒัััั โ ัั ััะฐะทั ะฟะพะปััะธัั ะฟัั-ัะฒะตะดะพะผะปะตะฝะธะต!"
)

# โ ะะตั ะฐะบัะธะฒะฝะพะน ะฟะพะดะฟะธัะบะธ
no_subs_text = (
    "โ ะฃ ัะตะฑั ะฝะตั ะฐะบัะธะฒะฝะพะน ะฟะพะดะฟะธัะบะธ Premium.\n"
    "๐ณ ะงัะพะฑั ะฟะพะปััะธัั ะดะพัััะฟ ะบ ะทะฐะบัััะพะผั ะบะฐะฝะฐะปั, ะพัะพัะผะธ ะฟะพะดะฟะธัะบั ะฝะฐ ะบััั ะฒ ะผะตะฝั ะฝะธะถะต."
)

# ๐ณ ะขะตะบัั ะพะฟะปะฐัั
pay_course_text = '๐ณ ะะฟะปะฐัะฐ ะบัััะฐ:'

# ๐ณ ะะตะฝั ะพะฟะปะฐัั
pay_time_text = "๐ณ ะะตะฝั ะพะฟะปะฐัั"

# โ ะฃัะฟะตัะฝะฐั ะฟะพะบัะฟะบะฐ
accept_course_text = (
    "\n\nโ ะะฐั ะฟะปะฐััะถ ะฑัะป ััะฟะตัะฝะพ ะทะฐะฒะตัััะฝ. ะกะฟะฐัะธะฑะพ ะทะฐ ะฟะพะบัะฟะบั!๐ธ\n\n"
)

# ๐๏ธ ะขะตัะฝะธัะตัะบะฐั ะฟะพะดะดะตัะถะบะฐ
support_message_text = (
    "๐๏ธ ะขะตัะฝะธัะตัะบะฐั ะฟะพะดะดะตัะถะบะฐ\n"
    "๐ค @this_is_originall"
)


# โณ ะฃะฒะตะดะพะผะปะตะฝะธะต ะพ ัะบะพัะพะผ ะทะฐะฒะตััะตะฝะธะธ ะฟะพะดะฟะธัะบะธ
async def push_subs_text(days_left: int) -> str:
    return (
        "โ๏ธ ะะฐัะฐ ะฟะพะดะฟะธัะบะฐ ะัะตะผะธัะผ ัะบะพัะพ ะทะฐะบะพะฝัะธััั!\n"
        f"๐ ะััะฐะปะพัั: {days_left} ะดะฝะตะน"
    )


# โ ะะฐะฒะตััะตะฝะธะต ะฟะพะดะฟะธัะบะธ
async def end_push_sub_text() -> str:
    return "๐ซ ะะฐัะฐ ะฟะพะดะฟะธัะบะฐ ะัะตะผะธัะผ ะทะฐะฒะตััะธะปะฐัั."


# ๐ค ะะพะปััะตะฝะธะต ัะตะบััะฐ ะฟัะพัะธะปั ะฟะพะปัะทะพะฒะฐัะตะปั
async def get_profile_text(telegram_id: int) -> str | None:
    user = await CrudeUser().get_user(telegram_id)
    if not user:
        return None

    subscription = await CrudeSubscriptions().get_user_subscriptions(telegram_id)

    profile_lines = [
        f"๐ค Telegram ID: {user.telegram_id}",
        f"๐ ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั: {user.user_name}",
    ]

    if subscription:
        profile_lines.append(f"๐ ะะพะดะฟะธัะบะฐ ะดะตะนััะฒัะตั ะดะพ:"
                             f"\n๐๏ธ{get_subscription_end_datetime(subscription.day_count)['date']}"
                             f"\nโฐ{get_subscription_end_datetime(subscription.day_count)['time']} ")

    return "\n".join(profile_lines)


# ะคัะฝะบัะธั ะดะปั ะฟะพะปััะตะฝะธั ะดะฐัั ะธ ะฒัะตะผะตะฝะธ ะพะบะพะฝัะฐะฝะธั ะฟะพะดะฟะธัะบะธ
def get_subscription_end_datetime(days: int) -> dict[str, str]:
    """
    ะะพะปััะฐะตั ะดะฐัั ะธ ะฒัะตะผั ะพะบะพะฝัะฐะฝะธั ะฟะพะดะฟะธัะบะธ ะฝะฐ ะพัะฝะพะฒะต ะบะพะปะธัะตััะฒะฐ ะดะฝะตะน.

    :param days: ะะพะปะธัะตััะฒะพ ะดะฝะตะน ะฟะพะดะฟะธัะบะธ
    :return: ะกะปะพะฒะฐัั ั ะบะปััะฐะผะธ 'date' ะธ 'time'
    """
    start_datetime = datetime.now()
    end_datetime = start_datetime + timedelta(days=days)

    return {
        'date': end_datetime.strftime('%d.%m.%Y'),
        'time': end_datetime.strftime('%H:%M:%S')
    }
